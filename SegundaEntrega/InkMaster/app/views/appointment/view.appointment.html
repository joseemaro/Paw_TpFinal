{% extends "base.html" %}

{% block title %}
    Turno
{% endblock %}

{% block head %}
    {{ parent() }}
    <meta name="keywords" content="PAW,2020,Templates,PHP">
    <link rel="stylesheet" type="text/css" href="/public/css/appointment/view.appointment.css">
    <link rel="stylesheet" type="text/css" href="/public/css/modal-images/gallery.modal.css">
    <script type="text/javascript" src="/public/js/gallery.modal.images.js"></script>
{% endblock %}

{% block header %}
    {{ include('header.views.html') }}
    {{ include('nav.views.html') }}
    <!--{{ include('session.views.html') }}-->
{% endblock %}

{% block main %}

<div class="ap-container"> 
    <div class="row-ap">
        <div class="col-left">
            <div class="user-data">
                <h1 class="title"> Datos del turno </h1>
                {% if (session) and (not variable.adult) %}
                <p class="red-alert">*El usuario al ser menor de 18 a침os deber치 asistir al establecimiento con su madre/padre/tutor*</p>
                {% endif %}
                {% if variable.appointment.link %}
                <form method="get" action="{{ variable.appointment.link }}" target="_blank">
                    <button class ="calendarBtn" type="submit">Google calendar</button>
                </form>
                {% endif %}
                <label for="fuser"> Usuario </label>
                <input id="fuser" type="text" name="id_user" readonly value="{{ variable.appointment.id_user }}">
                <label for="fartist"> Artista </label>
                <input id="fartist" type="text" name="id_artist" readonly value="{{ variable.appointment.id_artist }}">
                <label for="fdate"> Fecha </label>
                <input id="fdate" type="date" name="date" readonly value="{{ variable.appointment.date }}">
                <label for="fhour"> Horario (hh:min) </label>
                <input id="fhour" type="time" name="hour" readonly value="{{ variable.appointment.hour }}">
                <label for="festado"> Estado </label>
                <input id="festado" type="text" name="status" readonly value="{{ variable.appointment.status }}">
                {% if (variable.appointment.price is null) %}
                <label for="fprice"> Price </label>
                <input id="fprice" type="text" name="price" readonly value="-">
                {% else %}
                <label for="fprice"> Price </label>
                <input id="fprice"type="text" name="price" readonly value="{{ variable.appointment.price }}">
                {% endif %}
                {% if variable.appointment.txt %}
                <label for="fillness"> Enfermedades </label>
                <textarea id="fillness" name="pathology-txt" id="pathology-txt" pattern="^[a-zA-Z0-9+-.: ]{3,70}$" title="Solo se permiten letras, numeros, espacios, y +-.:" readonly> {{ variable.appointment.txt }}</textarea>
                {% endif %}
            </div>
        </div>
        <div class="col-right">
            <div>
                <div id="myModal" class="modal">
                    <span class="close">&times;</span>
                    <img class="modal-content" id="img01">
                    <div id="caption"></div>
                </div>
            
                <div class="container-img">
                {% if variable.appointment.reference_images %}
                    <div id="container-all-img">
                        {% for reference_image in variable.appointment.reference_images %}
                        <img class="myImg" src="data:image/png;base64, {{reference_image}}" alt="imagen de tattoo de referencia">
                        <p class="text-img">Im치gen(es) de referencia</p>
                        {% endfor %}
                    </div>
                {% else %}
                    <h1 class="title">No hay im치genes de referencia</h1>
                {% endif %}
                </div>
                <div class="artist-buttons">
                {% if isArtist %}
                    {% if (variable.appointment.status == 'pending') %}
                    <form method="get" id="acept-appointment-{{ variable.appointment.id_appointment }}" action="/acept_appointment/{{ variable.appointment.id_appointment }}">
                        <input type="hidden" name="id_appointment" value={{ variable.appointment.id_appointment }}>
                        <button class ="acceptBtn" type="submit" form="acept-appointment-{{ variable.appointment.id_appointment }}">Aceptar</button>
                    </form>
                    {% endif %}
                    {% if (variable.appointment.status != 'annulled') %}
                    <form method="get" id="edit-appointment-{{ variable.appointment.id_appointment }}" action="/edit_appointment/{{ variable.appointment.id_appointment }}">
                        <input type="hidden" name="id_appointment" value={{ appointment.id_appointment }}>
                        <button class ="editBtn" type="submit" form="edit-appointment-{{ variable.appointment.id_appointment }}">Editar</button>
                    </form>
                    {% endif %}
                    {% if (variable.appointment.status == 'pending') %}
                        <form method="get" id="destroy-appointment-{{ variable.appointment.id_appointment }}" action="/del_appointment/{{ variable.appointment.id_appointment }}" onSubmit="return confirm('Desea eliminar el turno?');">
                            <input type="hidden" name="id_appointment" value={{ appointment.id_appointment }}>
                            <button class ="deleteBtn" type="submit" form="destroy-appointment-{{ variable.appointment.id_appointment }}">Eliminar</button>
                        </form>
                    {% endif %}
                {% endif %}
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block footer %}
    {{ include('footer.views.html') }}
{% endblock %}